version: '2'
services:
  unbound:
    build: ./unbound
    restart: always    
    ports:
    - "53:53/udp"
    depends_on:
    - fluentd
  kea:
    build: ./kea
    restart: always    
    network_mode: host
    env_file:
    - ./mysql.env
    depends_on:
    - fluentd
  kea-db:
    build: ./kea-db
    restart: always    
    ports:
    - 3306:3306
    env_file:
    - ./mysql.env
    volumes:
    - kea-db-vol:/var/lib/mysql
    depends_on:
    - fluentd
  fluentd:
    build: ./fluentd
    restart: always
    ports:
    - 24224:24224
    - 5514:5514/udp
    volumes:
    - fluentd-buffer:/var/log/fluentd
volumes:
  kea-db-vol:
  fluentd-buffer:
